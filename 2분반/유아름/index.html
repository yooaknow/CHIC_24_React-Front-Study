<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JSON to HTML Table</title>
    <style>
        th:hover {
            cursor: pointer;
        }
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }
        .asc::after {
            content: " ↓";
        }
        .desc::after {
            content: " ↑";
        }
        .filteroff {
            display: inline-block;
            width: 50px;
            text-align: center;
            border: 1px solid black;
            border-radius: 5px;
            margin: 5px;
            padding: 5px;
            cursor: pointer;
        }
        .filteron {
            display: inline-block;
            width: 50px;
            text-align: center;
            border: 1px solid black;
            border-radius: 5px;
            margin: 5px;
            padding: 5px;
            cursor: pointer;
            background-color: yellow;
        }
    </style>
</head>
<body>
    <h1>JSON to HTML Table</h1>
    <span id="all" class="filteron">전체</span>
    <span class="filteroff">서울</span>
    <span class="filteroff">부산</span>
    <span class="filteroff">대구</span>
    <table id="jsonTable">
        <thead>
            <tr>
                <th data-index="0">Name</th>
                <th data-index="1">Age</th>
                <th data-index="2">City</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        // JSON 데이터
        var jsonData = [
        {
          Name: "박지영",
          Age: 33,
          City: "제주",
        },
        {
          Name: "김태희",
          Age: 43,
          City: "세종",
        },
        {
          Name: "정수빈",
          Age: 55,
          City: "강릉",
        },
        {
          Name: "박지영",
          Age: 46,
          City: "부산",
        },
        {
          Name: "김태희",
          Age: 27,
          City: "서울",
        },
        {
          Name: "정수빈",
          Age: 31,
          City: "대전",
        },
        {
          Name: "정수빈",
          Age: 36,
          City: "제주",
        },
        {
          Name: "이민호",
          Age: 48,
          City: "부산",
        },
        {
          Name: "정수빈",
          Age: 61,
          City: "부산",
        },
        {
          Name: "박지영",
          Age: 54,
          City: "서울",
        },
        {
          Name: "이민호",
          Age: 40,
          City: "인천",
        },
        {
          Name: "이민호",
          Age: 28,
          City: "제주",
        },
        {
          Name: "김철수",
          Age: 58,
          City: "부산",
        },
        {
          Name: "서영희",
          Age: 30,
          City: "인천",
        },
        {
          Name: "이민호",
          Age: 68,
          City: "제주",
        },
        {
          Name: "서영희",
          Age: 67,
          City: "제주",
        },
        {
          Name: "김태희",
          Age: 48,
          City: "울산",
        },
        {
          Name: "이민호",
          Age: 46,
          City: "서울",
        },
        {
          Name: "서영희",
          Age: 56,
          City: "대구",
        },
        {
          Name: "박지영",
          Age: 24,
          City: "서울",
        },
        {
          Name: "김태희",
          Age: 39,
          City: "제주",
        },
        {
          Name: "김철수",
          Age: 30,
          City: "제주",
        },
        {
          Name: "김태희",
          Age: 62,
          City: "대전",
        },
        {
          Name: "김철수",
          Age: 39,
          City: "부산",
        },
        {
          Name: "정수빈",
          Age: 41,
          City: "부산",
        },
        {
          Name: "송혜교",
          Age: 29,
          City: "인천",
        },
        {
          Name: "최영희",
          Age: 34,
          City: "세종",
        },
        {
          Name: "박지영",
          Age: 61,
          City: "대구",
        },
        {
          Name: "김철수",
          Age: 66,
          City: "인천",
        },
        {
          Name: "박지영",
          Age: 50,
          City: "세종",
        },
        {
          Name: "김태희",
          Age: 49,
          City: "대구",
        },
        {
          Name: "홍길동",
          Age: 69,
          City: "부산",
        },
        {
          Name: "송혜교",
          Age: 60,
          City: "강릉",
        },
        {
          Name: "송혜교",
          Age: 48,
          City: "울산",
        },
        {
          Name: "김철수",
          Age: 59,
          City: "대구",
        },
        {
          Name: "김철수",
          Age: 61,
          City: "대전",
        },
        {
          Name: "최영희",
          Age: 58,
          City: "대구",
        },
        {
          Name: "정수빈",
          Age: 30,
          City: "인천",
        },
        {
          Name: "김철수",
          Age: 36,
          City: "강릉",
        },
        {
          Name: "최영희",
          Age: 63,
          City: "강릉",
        },
        {
          Name: "박지영",
          Age: 29,
          City: "부산",
        },
        {
          Name: "홍길동",
          Age: 23,
          City: "광주",
        },
        {
          Name: "정수빈",
          Age: 46,
          City: "대구",
        },
        {
          Name: "정수빈",
          Age: 28,
          City: "세종",
        },
        {
          Name: "박지영",
          Age: 49,
          City: "울산",
        },
        {
          Name: "이민호",
          Age: 33,
          City: "제주",
        },
        {
          Name: "홍길동",
          Age: 44,
          City: "대전",
        },
        {
          Name: "장미경",
          Age: 27,
          City: "강릉",
        },
        {
          Name: "박지영",
          Age: 51,
          City: "광주",
        },
        {
          Name: "김태희",
          Age: 46,
          City: "대전",
        },
        {
          Name: "최영희",
          Age: 24,
          City: "광주",
        },
        {
          Name: "송혜교",
          Age: 43,
          City: "인천",
        },
        {
          Name: "정수빈",
          Age: 48,
          City: "울산",
        },
        {
          Name: "장미경",
          Age: 43,
          City: "울산",
        },
        {
          Name: "송혜교",
          Age: 25,
          City: "서울",
        },
        {
          Name: "최영희",
          Age: 50,
          City: "서울",
        },
        {
          Name: "홍길동",
          Age: 51,
          City: "서울",
        },
        {
          Name: "정수빈",
          Age: 20,
          City: "제주",
        },
        {
          Name: "송혜교",
          Age: 44,
          City: "강릉",
        },
        {
          Name: "김태희",
          Age: 20,
          City: "대구",
        },
        {
          Name: "박지영",
          Age: 43,
          City: "부산",
        },
        {
          Name: "서영희",
          Age: 56,
          City: "서울",
        },
        {
          Name: "장미경",
          Age: 28,
          City: "부산",
        },
        {
          Name: "박지영",
          Age: 52,
          City: "인천",
        },
        {
          Name: "최영희",
          Age: 43,
          City: "대전",
        },
        {
          Name: "김철수",
          Age: 20,
          City: "광주",
        },
        {
          Name: "송혜교",
          Age: 36,
          City: "울산",
        },
        {
          Name: "홍길동",
          Age: 56,
          City: "부산",
        },
        {
          Name: "김태희",
          Age: 36,
          City: "인천",
        },
        {
          Name: "송혜교",
          Age: 49,
          City: "강릉",
        },
        {
          Name: "홍길동",
          Age: 69,
          City: "부산",
        },
        {
          Name: "김철수",
          Age: 28,
          City: "서울",
        },
        {
          Name: "서영희",
          Age: 52,
          City: "부산",
        },
        {
          Name: "이민호",
          Age: 53,
          City: "대구",
        },
        {
          Name: "김철수",
          Age: 39,
          City: "울산",
        },
        {
          Name: "최영희",
          Age: 41,
          City: "광주",
        },
        {
          Name: "김철수",
          Age: 48,
          City: "강릉",
        },
        {
          Name: "서영희",
          Age: 43,
          City: "대전",
        },
        {
          Name: "김태희",
          Age: 30,
          City: "부산",
        },
        {
          Name: "장미경",
          Age: 50,
          City: "광주",
        },
        {
          Name: "김철수",
          Age: 38,
          City: "강릉",
        },
        {
          Name: "최영희",
          Age: 69,
          City: "세종",
        },
        {
          Name: "최영희",
          Age: 31,
          City: "강릉",
        },
        {
          Name: "박지영",
          Age: 35,
          City: "강릉",
        },
        {
          Name: "홍길동",
          Age: 27,
          City: "부산",
        },
        {
          Name: "송혜교",
          Age: 60,
          City: "대전",
        },
        {
          Name: "김태희",
          Age: 67,
          City: "대전",
        },
        {
          Name: "박지영",
          Age: 54,
          City: "제주",
        },
        {
          Name: "김철수",
          Age: 51,
          City: "인천",
        },
        {
          Name: "이민호",
          Age: 23,
          City: "부산",
        },
        {
          Name: "송혜교",
          Age: 53,
          City: "서울",
        },
        {
          Name: "김철수",
          Age: 60,
          City: "서울",
        },
        {
          Name: "김태희",
          Age: 32,
          City: "대전",
        },
        {
          Name: "송혜교",
          Age: 60,
          City: "세종",
        },
        {
          Name: "홍길동",
          Age: 29,
          City: "대전",
        },
        {
          Name: "최영희",
          Age: 31,
          City: "대구",
        },
        {
          Name: "서영희",
          Age: 46,
          City: "부산",
        },
        {
          Name: "홍길동",
          Age: 48,
          City: "대구",
        },
        {
          Name: "서영희",
          Age: 62,
          City: "대전",
        },
        {
          Name: "장미경",
          Age: 50,
          City: "인천",
        },
      ];

          // 정렬 상태를 저장하는 객체, 초기값은 'asc'
          let sortOrder = { Name: 'asc', Age: 'asc', City: 'asc' };
          // 현재 선택된 필터 값, 기본값은 'all'
          let currentFilter = 'all';

          // JSON 데이터를 기반으로 테이블을 생성하는 함수
          function createTableFromJSON() {
              // 테이블과 본문 요소를 가져옴
              const table = document.getElementById('jsonTable');
              const tbody = table.querySelector('tbody');
              tbody.innerHTML = ''; // 기존 테이블 내용을 지움

              // 현재 필터에 따라 데이터를 필터링
              let filteredData = jsonData;
              if (currentFilter !== 'all') {
                  filteredData = jsonData.filter(item => item.City === currentFilter);
              }

              // 정렬할 열의 필드를 결정
              const column = table.querySelector('th.asc') || table.querySelector('th.desc');
              let field = 'Name'; // 기본값은 'Name'
              if (column) {
                  const index = column.dataset.index;
                  field = ['Name', 'Age', 'City'][index];
              }

              // 데이터를 정렬
              let sortedData = filteredData.slice();
              if (field) {
                  sortedData.sort(function(a, b) {
                      let aValue = a[field];
                      let bValue = b[field];
                      
                      // 오름차순 또는 내림차순에 따라 정렬
                      if (sortOrder[field] === 'asc') {
                          if (aValue > bValue) return 1;
                          if (aValue < bValue) return -1;
                      } else {
                          if (aValue > bValue) return -1;
                          if (aValue < bValue) return 1;
                      }
                      return 0; // 같으면 변화 없음
                  });
              }

              // 정렬된 데이터를 테이블에 추가
              sortedData.forEach(({ Name, Age, City }) => {
                  const row = tbody.insertRow();
                  row.insertCell().textContent = Name;
                  row.insertCell().textContent = Age;
                  row.insertCell().textContent = City;
              });
          }

          // 열을 클릭하면 정렬 방식을 변경하는 함수
          function handleSort(event) {
              const th = event.target;
              const index = th.dataset.index;
              const field = ['Name', 'Age', 'City'][index];

              // 현재 정렬 상태를 업데이트
              if (field) {
                  document.querySelectorAll('th').forEach(th => th.classList.remove('asc', 'desc'));
                  sortOrder[field] = (sortOrder[field] === 'asc') ? 'desc' : 'asc';
                  th.classList.add(sortOrder[field]);
                  createTableFromJSON(); // 테이블을 다시 그림
              }
          }

          // 필터를 클릭하면 필터를 적용
              function handleFilter(event) {
              const text = event.target.textContent;
              currentFilter = (text === '전체') ? 'all' : text;

              // 현재 활성화된 필터를 업데이트
              document.querySelectorAll('.filteron').forEach(span => span.classList.replace('filteron', 'filteroff'));
              event.target.classList.replace('filteroff', 'filteron');
              createTableFromJSON(); // 테이블을 다시 그립니다
          }

          // 각 열 헤더에 클릭 이벤트 리스너를 추가
          document.querySelectorAll('th').forEach(th => th.addEventListener('click', handleSort));
          // 필터 버튼에 클릭 이벤트 리스너를 추가
          document.querySelectorAll('.filteroff').forEach(span => span.addEventListener('click', handleFilter));
          document.getElementById('all').addEventListener('click', handleFilter);

          // 페이지가 로드될 때 테이블을 초기화
          window.onload = createTableFromJSON;
      </script>
  </body>
  </html>